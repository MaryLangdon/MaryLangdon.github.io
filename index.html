<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ´›çªå¸Œçš„æŸ³å·å¤©æ°”é¢„æŠ¥</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font for clean typography -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light gray background for MD3 feel */
        }
        .roxy-gradient {
            /* Roxy's theme colors: Blue/Purple magic */
            background-image: linear-gradient(135deg, #4c51bf 0%, #6366f1 100%);
        }
    </style>
    <script>
        // Tailwind configuration for custom colors (MD3 inspired)
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#6366f1', // Indigo/Violet for main accent
                        'surface-light': '#ffffff',
                        'surface-dark': '#e0e7ff', // Light blue background for cards
                        'on-surface': '#1f2937',
                    },
                    boxShadow: {
                        'md3': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
                        'md3-lg': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <!-- Main Container Card (MD3 Style) -->
    <div class="w-full max-w-2xl bg-surface-light rounded-3xl shadow-md3-lg overflow-hidden transition-all duration-300">
        
        <!-- Header: Roxy Theme -->
        <div class="roxy-gradient text-white p-6 sm:p-8 flex flex-col sm:flex-row items-center justify-between rounded-t-3xl">
            <div class="text-center sm:text-left mb-4 sm:mb-0">
                <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight">
                    æ´›çªå¸Œçš„<span id="location-display">æŸ³å·</span>å¤©æ°”
                </h1>
                <p class="text-sm sm:text-lg opacity-90 font-light">
                    â€œæ„¿æ‚¨ä»Šå¤©ä¹Ÿæ²æµ´åœ¨é­”åŠ›ä¹‹å…‰ä¸‹â€
                </p>
            </div>
            <!-- Roxy Icon Placeholder (Magic Staff / Star) -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-16 h-16 sm:w-20 sm:h-20 text-white opacity-80">
                <path fill-rule="evenodd" d="M3.75 6.75a3 3 0 0 0 3-3h.007a.75.75 0 0 1 .59 1.203l-1.558 1.559a.15.15 0 0 1-.225 0V4.5A.75.75 0 0 1 6 3.75 3 3 0 0 0 3 6.75Z" clip-rule="evenodd" />
                <path fill-rule="evenodd" d="m11.546 8.329 7.746-.775a.75.75 0 0 0 .708-.708L19.5 7.5a.75.75 0 0 0-.75-.75h-2.25a.75.75 0 0 1-.53-.22L13.195 4.3a.75.75 0 0 0-1.06 0L9.48 6.53a.75.75 0 0 1-.53.22H6.75a.75.75 0 0 0-.75.75v.005l.004.05a7.7 7.7 0 0 1 1.708 7.214l-.235 1.175a.75.75 0 0 0 .584.854l1.378.276c.492.098.995.148 1.5.148h.002c.866 0 1.714-.14 2.518-.418l2.905-.969a.75.75 0 0 0 .474-.698V14.4l-1.465-1.466a2.25 2.25 0 0 1-1.282-.992l-.11-.224a1.75 1.75 0 0 0-3.204-.32l-.248.992a.15.15 0 0 1-.216.082l-1.071-.714a.15.15 0 0 0-.174.03l-.442.441a.75.75 0 0 1-.53.22H6.75a.75.75 0 0 0-.75.75v1.5a.75.75 0 0 0 1.5 0v-1.5h.721c.216 0 .428-.052.624-.153l.492-.246a.15.15 0 0 1 .158-.023l.534.267a1.75 1.75 0 0 0 3.204-.32l.22-.88a.75.75 0 0 1 .804-.619l1.107.554a.75.75 0 0 0 .694.072l2.368-1.579a.75.75 0 0 0 .22-.644Z" clip-rule="evenodd" />
            </svg>
        </div>

        <!-- Loading / Error Message Area -->
        <div id="loading-spinner" class="p-8 text-center" style="display: none;">
            <div class="animate-spin rounded-full h-12 w-12 border-4 border-primary-blue border-t-transparent mx-auto mb-4"></div>
            <p class="text-on-surface">æ­£åœ¨å‘é­”ç•Œå‘é€å¤©æ°”è¯·æ±‚...</p>
        </div>

        <div id="error-message" class="p-8 text-center text-red-600 bg-red-100 hidden rounded-b-3xl">
            <p class="font-semibold">é”™è¯¯ï¼šæ— æ³•è·å–å¤©æ°”æ•°æ®ã€‚</p>
            <p class="text-sm mt-2">è¯·æ£€æŸ¥ API åœ°å€æˆ–ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸ã€‚</p>
        </div>

        <!-- Weather Content Cards -->
        <div id="weather-content" class="p-6 sm:p-8 space-y-6 hidden">
            
            <!-- Main Temperature Card -->
            <div class="flex flex-col sm:flex-row items-center justify-center bg-surface-dark p-6 rounded-2xl shadow-md3">
                <div class="flex-shrink-0 mb-4 sm:mb-0 sm:mr-6 text-primary-blue">
                    <!-- Icon Placeholder - will be updated by JS -->
                    <h2 id="weather-icon" class="text-7xl">---</h2> 
                </div>
                <div class="text-center sm:text-left">
                    <!-- Open-Meteo does not provide descriptive summaries easily, so we show the current time and temperature. -->
                    <p id="description" class="text-3xl font-semibold text-on-surface">å½“å‰å¤©æ°”çŠ¶å†µ</p>
                    <div class="flex items-baseline mt-1">
                        <span id="temp" class="text-6xl font-extrabold text-on-surface">--Â°C</span>
                        <span id="weather-code" class="ml-4 text-lg text-gray-600">--</span>
                    </div>
                    <p id="temp-range" class="text-md text-gray-500 mt-1">ä»Šæ—¥ï¼šæœ€ä½ --Â°C / æœ€é«˜ --Â°C</p>
                </div>
            </div>

            <!-- Detail Grid (Two Columns) -->
            <div class="grid grid-cols-2 gap-4">
                
                <!-- Wind Speed Card -->
                <div class="bg-surface-dark p-4 rounded-2xl shadow-md3 flex flex-col items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-primary-blue mb-1">
                        <path d="M11.5 2.75a.75.75 0 0 1 .75.75v5.437l.794-.794a.75.75 0 1 1 1.06 1.06L12.56 12.31l-3.375-3.375a.75.75 0 1 1 1.06-1.06l.794.793V3.5a.75.75 0 0 1 .75-.75Z" />
                        <path d="M4.5 13.5a.75.75 0 0 0-.75.75v5.25c0 .414.336.75.75.75h15c.414 0 .75-.336.75-.75v-5.25a.75.75 0 0 0-1.5 0v5.25h-13.5v-5.25a.75.75 0 0 0-.75-.75Z" />
                    </svg>
                    <p class="text-sm text-gray-600">é£é€Ÿ</p>
                    <p id="wind-speed" class="text-xl font-bold text-on-surface">-- km/h</p>
                </div>
                
                <!-- Humidity Card -->
                <div class="bg-surface-dark p-4 rounded-2xl shadow-md3 flex flex-col items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-primary-blue mb-1">
                        <path d="M12 2.25a6.75 6.75 0 0 0-6.75 6.75c0 3.784-1.5 6.425-3.084 7.641A4.5 4.5 0 0 0 5.625 22.5h12.75a4.5 4.5 0 0 0 3.084-1.859c-1.584-1.216-3.084-3.857-3.084-7.641A6.75 6.75 0 0 0 12 2.25Z" />
                    </svg>
                    <p class="text-sm text-gray-600">ç›¸å¯¹æ¹¿åº¦</p>
                    <p id="humidity" class="text-xl font-bold text-on-surface">-- %</p>
                </div>
                
                <!-- Pressure Card -->
                <div class="bg-surface-dark p-4 rounded-2xl shadow-md3 flex flex-col items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-primary-blue mb-1">
                        <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm4.28 10.28a.75.75 0 0 0 0-1.06l-3.5-3.5a.75.75 0 0 0-1.06 0l-3.5 3.5a.75.75 0 0 0 1.06 1.06l2.97-2.97v6.44a.75.75 0 0 0 1.5 0v-6.44l2.97 2.97Z" clip-rule="evenodd" />
                    </svg>
                    <p class="text-sm text-gray-600">æµ·å¹³é¢æ°”å‹</p>
                    <p id="pressure" class="text-xl font-bold text-on-surface">-- hPa</p>
                </div>
                
                <!-- Apparent Temperature Card -->
                <div class="bg-surface-dark p-4 rounded-2xl shadow-md3 flex flex-col items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-primary-blue mb-1">
                        <path d="M16.125 10.5C18.687 10.5 21 12.813 21 15.75c0 2.417-1.156 4.706-2.934 6.138A7.323 7.323 0 0 1 12 22.5c-2.43 0-4.706-1.157-6.138-2.934-1.782-1.432-2.934-3.721-2.934-6.138 0-2.937 2.313-5.25 4.875-5.25a.75.75 0 0 1 0 1.5c-2.094 0-3.75 1.706-3.75 3.75 0 2.327 1.144 4.148 2.662 5.344a6.772 6.772 0 0 0 8.176 0c1.518-1.196 2.662-3.017 2.662-5.344 0-2.042-1.656-3.714-3.75-3.75a.75.75 0 0 1 0-1.5ZM17.16 8.368c.07-.376-.046-.74-.326-1.02a.75.75 0 0 0-1.06 0l-.364.363L14.73 7.02l.363-.364a.75.75 0 0 0 0-1.06 3.01 3.01 0 0 0-3.32-.423L11 5.176V3.75a.75.75 0 0 0-1.5 0v1.426l-.014.004a3.01 3.01 0 0 0-3.32-.423.75.75 0 0 0 0 1.06l.363.364-.364.364a.75.75 0 0 0 0 1.06c.28.28.655.396 1.02.326.368-.07.697-.246.953-.473.256-.227.46-.497.604-.803a.15.15 0 0 1 .277.01c.214.46.596.868 1.05.795a.15.15 0 0 1 .155.153V10.5a.75.75 0 0 0 1.5 0V8.924c.036.007.07.014.105.014.368 0 .736-.18 1.02-.459.28-.28.396-.656.326-1.02Z" />
                    </svg>
                    <p class="text-sm text-gray-600">ä½“æ„Ÿæ¸©åº¦</p>
                    <p id="apparent-temp" class="text-xl font-bold text-on-surface">--Â°C</p>
                </div>

            </div>
            
            <p class="text-sm text-gray-400 text-center pt-4">æ•°æ®æ›´æ–°äº: <span id="update-time">--</span></p>

        </div>

        <div id="footer-note" class="p-4 text-xs text-center text-gray-500 border-t mt-4 rounded-b-3xl">
            æ•°æ®æ¥æº: Open-Meteo.com (å…è´¹å¼€æ”¾ APIï¼Œæ— éœ€å¯†é’¥)
        </div>

    </div>

    <!-- JavaScript for Fetching Weather Data -->
    <script>
        // Open-Meteo API URL for current weather data
        const LATITUDE = 24.33; // æŸ³å·å¤§è‡´çº¬åº¦
        const LONGITUDE = 109.41; // æŸ³å·å¤§è‡´ç»åº¦
        // è¯·æ±‚å½“å‰æ¸©åº¦ã€ä½“æ„Ÿæ¸©åº¦ã€å¤©æ°”ä»£ç ã€æµ·å¹³é¢æ°”å‹ã€ç›¸å¯¹æ¹¿åº¦ã€é£é€Ÿå’Œæ¯æ—¥çš„æœ€é«˜æœ€ä½æ¸©åº¦
        const API_URL = `https://api.open-meteo.com/v1/forecast?latitude=${LATITUDE}&longitude=${LONGITUDE}&current=temperature_2m,apparent_temperature,weather_code,surface_pressure,relative_humidity_2m,wind_speed_10m&daily=temperature_2m_max,temperature_2m_min&timezone=Asia%2FSingapore`;

        const locationDisplay = document.getElementById('location-display');
        const loadingSpinner = document.getElementById('loading-spinner');
        const errorMessageDiv = document.getElementById('error-message');
        const weatherContentDiv = document.getElementById('weather-content');
        const descriptionEl = document.getElementById('description');
        const tempEl = document.getElementById('temp');
        const weatherCodeEl = document.getElementById('weather-code');
        const tempRangeEl = document.getElementById('temp-range');
        const windSpeedEl = document.getElementById('wind-speed');
        const humidityEl = document.getElementById('humidity');
        const pressureEl = document.getElementById('pressure');
        const apparentTempEl = document.getElementById('apparent-temp');
        const updateTimeEl = document.getElementById('update-time');
        const weatherIconEl = document.getElementById('weather-icon');

        /**
         * WMO Weather Interpretation Codes (WMO CODE) to Chinese description and Emoji.
         * Open-Meteo uses WMO codes instead of simple strings.
         * @param {number} code - The WMO weather code.
         * @returns {{description: string, emoji: string}} Description and Emoji.
         */
        function getWeatherWmoInfo(code) {
            switch (code) {
                case 0: return { description: 'æ™´æœ—', emoji: 'â˜€ï¸' };
                case 1: return { description: 'å¤šäº‘ä¸ºä¸»', emoji: 'ğŸŒ¤ï¸' };
                case 2: return { description: 'éƒ¨åˆ†å¤šäº‘', emoji: 'â›…' };
                case 3: return { description: 'é˜´å¤©', emoji: 'â˜ï¸' };
                case 45: return { description: 'é›¾', emoji: 'ğŸŒ«ï¸' };
                case 48: return { description: 'é›¾å‡‡', emoji: 'ğŸŒ«ï¸â„ï¸' };
                case 51: return { description: 'å°é›¨', emoji: 'ğŸŒ§ï¸' };
                case 53: return { description: 'ä¸­é›¨', emoji: 'ğŸŒ§ï¸' };
                case 55: return { description: 'å¤§é›¨', emoji: 'ğŸŒ§ï¸' };
                case 61: return { description: 'å°åˆ°ä¸­é›¨', emoji: 'â˜”' };
                case 63: return { description: 'ä¸­åˆ°å¤§é›¨', emoji: 'â˜”' };
                case 65: return { description: 'æš´é›¨', emoji: 'â˜”' };
                case 71: return { description: 'å°é›ª', emoji: 'ğŸŒ¨ï¸' };
                case 73: return { description: 'ä¸­é›ª', emoji: 'ğŸŒ¨ï¸' };
                case 75: return { description: 'å¤§é›ª', emoji: 'ğŸŒ¨ï¸' };
                case 80: return { description: 'é˜µé›¨', emoji: 'ğŸŒ¦ï¸' };
                case 81: return { description: 'ä¸­ç­‰é˜µé›¨', emoji: 'ğŸŒ¦ï¸' };
                case 82: return { description: 'å¼ºçƒˆé˜µé›¨', emoji: 'â›ˆï¸' };
                case 95: return { description: 'é›·æš´', emoji: 'âš¡' };
                default: return { description: 'æœªçŸ¥å¤©æ°”ä»£ç ', emoji: 'â“' };
            }
        }

        /**
         * Displays an error message and hides the content.
         * @param {string} message - The error message to display in the console.
         */
        function showError(message) {
            console.error("Weather Fetch Error:", message);
            loadingSpinner.style.display = 'none';
            weatherContentDiv.classList.add('hidden');
            errorMessageDiv.classList.remove('hidden');
        }

        /**
         * Fetches weather data from Open-Meteo API (free and no key required).
         */
        async function fetchWeather() {
            loadingSpinner.style.display = 'block';
            errorMessageDiv.classList.add('hidden');
            weatherContentDiv.classList.add('hidden');
            
            try {
                const response = await fetch(API_URL);
                if (!response.ok) {
                    throw new Error(`HTTP Error: ${response.status}`);
                }

                const data = await response.json();
                
                // æ£€æŸ¥æ˜¯å¦åŒ…å«é¢„æœŸçš„å½“å‰å¤©æ°”æ•°æ®
                if (!data.current || !data.daily || !data.daily.time || data.daily.time.length === 0) {
                    throw new Error("APIè¿”å›æ•°æ®æ ¼å¼ä¸æ­£ç¡®ï¼Œç¼ºå°‘å½“å‰æˆ–æ¯æ—¥æ•°æ®ã€‚");
                }
                
                const current = data.current;
                const daily = data.daily;

                // --- æå–å’Œæ›´æ–° UI ---
                
                const weatherInfo = getWeatherWmoInfo(current.weather_code);
                
                // ä¸»æ˜¾ç¤º
                const temp = Math.round(current.temperature_2m);
                const apparentTemp = Math.round(current.apparent_temperature);
                
                // æ¯æ—¥æœ€é«˜æ¸©å’Œæœ€ä½æ¸©ï¼ˆOpen-Meteoè¿”å›æ•°ç»„ï¼Œå–ç¬¬ä¸€ä¸ªå…ƒç´ å³ä»Šå¤©ï¼‰
                const minTemp = Math.round(daily.temperature_2m_min[0]);
                const maxTemp = Math.round(daily.temperature_2m_max[0]);
                
                descriptionEl.textContent = weatherInfo.description;
                tempEl.textContent = `${temp}Â°C`;
                weatherCodeEl.textContent = `WMO ç : ${current.weather_code}`;
                tempRangeEl.textContent = `ä»Šæ—¥ï¼šæœ€ä½ ${minTemp}Â°C / æœ€é«˜ ${maxTemp}Â°C`;
                weatherIconEl.textContent = weatherInfo.emoji; // Set the emoji

                // ç»†èŠ‚å¡ç‰‡
                // Open-Meteoé£é€Ÿé»˜è®¤ä¸º km/hï¼Œç›¸å¯¹æ¹¿åº¦ä¸º %ï¼Œæ°”å‹ä¸º hPaã€‚
                windSpeedEl.textContent = `${current.wind_speed_10m.toFixed(1)} km/h`;
                humidityEl.textContent = `${current.relative_humidity_2m} %`;
                pressureEl.textContent = `${current.surface_pressure.toFixed(0)} hPa`; 
                apparentTempEl.textContent = `${apparentTemp}Â°C`; 
                
                // æ›´æ–°æ—¶é—´
                const date = new Date(current.time);
                // æ ¼å¼åŒ–æ—¶é—´ä¸ºæœ¬åœ°æ—¶é—´å­—ç¬¦ä¸²
                updateTimeEl.textContent = date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit', second: '2-digit', timeZoneName: 'short' });

                // æ˜¾ç¤ºå†…å®¹
                loadingSpinner.style.display = 'none';
                weatherContentDiv.classList.remove('hidden');

            } catch (error) {
                locationDisplay.textContent = 'é”™è¯¯';
                showError(error.message);
            }
        }

        // Initialize on load
        window.onload = function() {
            fetchWeather();
        };

    </script>
</body>
</html>
